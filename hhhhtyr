<p align="center">  
  <img src="https://i.imgur.com/MNlo0V7.jpeg" alt="Cybersecurity Portfolio Banner" width="100%">  
</p>

*Client:* [TryHackMe â€” Room #27 (Internal)](https://tryhackme.com/room/internal) â€” Educational  
*Project:* Internal Network & Privilege Escalation Assessment  
*Date:* November 20, 2025  
*Version:* 1.1 (A+ Premium â€” HackerOneâ€‘Ready Edition)  
*Prepared by:* Asibur Rahaman  
*Title:* Ethical Hacker & Cybersecurity Specialist  
*Contact:* [ðŸ“§ asib51639@gmail.com](mailto:asib51639@gmail.com) | [ðŸŒ GitHub â€” Asibur-syber](https://github.com/Asibur-syber)  

---

## Table of Contents

1. [Executive TL;DR](#executive-tldr)
2. [Scope & Engagement](#scope--engagement)
3. [Testing Tools & Environment](#testing-tools--environment)
4. [Findings Overview (Summary)](#findings-overview-summary)
5. [Detailed Vulnerability Analysis](#detailed-vulnerability-analysis)
    - [INT-01 â€” SMB: Null/Weak Authentication](#int-01--smb-nullweak-authentication--sharable-scripts-high)
    - [INT-02 â€” Hardâ€‘coded Credentials](#int-02--hardcoded-credentials-in-deployed-script-high)
    - [INT-03 â€” Excessive Sudo rights](#int-03--excessive-sudo-rights-for-service-account-high)
    - [INT-04 â€” Unpatched Internal Tool](#int-04--unpatched-internal-tool-high)
    - [INT-05 â€” Insecure Temporary File Usage](#int-05--insecure-temporary-file-usage-medium)
6. [Exploitation Timeline](#exploitation-timeline)
7. [Technical Proof & Screenshots](#technical-proof--screenshots-redacted-references)
8. [Remediation Roadmap](#remediation-roadmap-prioritized-with-tickets)
9. [CVSS & CWE Justification](#cvss--cwe-justification)
10. [Risk Matrix & Business Impact](#risk-matrix--business-impact)
11. [Delivery Package & Notes](#delivery-package--notes)
12. [Evidence / Redaction Policy](#evidence--redaction-policy)
13. [Oneâ€‘page Executive Summary](#onepage-executive-summary-boardready)
14. [Fiverr / Clientâ€‘Ready Package Suggestions](#fiverr--clientready-package-suggestions)
15. [References & Framework Mapping](#references--framework-mapping)
16. [Personal Note to Client](#personal-note-to-client)

---

## Executive TL;DR

*Objective:* Assess the Internal VM ([TryHackMe Room #27](https://tryhackme.com/room/internal) â€” IP: *10.65.147.161*) for internal network misconfiguration, SMB weaknesses, credential exposure, lateral movement opportunities, and local privilege escalation.

*Executive Summary (short):* Initial reconnaissance identified anonymous SMB access exposing deployment scripts and artifacts. Files contained hardâ€‘coded secrets and a service account possessed overly broad sudo rights (including NOPASSWD). An outdated internal tool with a known local exploit facilitated privilege escalation in lab conditions. Combined, these issues enable an attacker with low privileges to pivot and escalate to root â€” *High overall risk*.

*Immediate Business Risk:* Local compromise could yield unauthorized data access, persistence, and lateral movement across internal hosts if similar misconfigurations exist elsewhere. Immediate remediation advised.

*Status:* Findings verified in lab scope. Public artifacts redacted. Full raw logs & screenshots available under NDA.

---

## Scope & Engagement

### In Scope
* *Internal VM* â€” TryHackMe Room #27 (IP: *10.65.147.161*)
* Host services: SMB shares, deployed scripts, local filesystem and local service binaries
* Local privilege escalation vectors and lateral movement vectors within the lab environment

### Out of Scope
* Denial-of-Service (DoS) testing
* External networks or systems beyond TryHackMe lab hosts

### Methodology (high-level)
1.  *Reconnaissance* (Nmap, ARP, host discovery)
2.  *Service & credential enumeration* (SMB, SSH, RPC, file inspection)
3.  *Verification PoC* (safe, non-destructive, lab-only)
4.  *Privilege escalation checks* (LinPEAS, manual verification)
5.  *Documentation & prioritized remediation*

*Rules of Engagement:* All testing performed within TryHackMe lab scope under authorization. PoCs are non-destructive; no production systems targeted.

---

## Testing Tools & Environment

| Tool | Purpose | Version / Notes |
| :--- | :--- | :--- |
| *Nmap* | Port & service discovery, version detection | nmap 7.93 |
| *smbclient / enum4linux* | SMB share enumeration & metadata | smbclient 4.x / enum4linux scripts |
| *Gobuster* | Directory & share enumeration | gobuster 3.x |
| *Python* | PoC helpers, reverse shell (lab only) | Python 3.11 |
| *Netcat (nc)* | Connection validation | nc (openbsd) |
| *LinPEAS / PEASS-ng* | PrivEsc enumeration | PEASS-ng latest |
| *Metasploit* | Exploit verification in lab only | used as reference, not shipped |

### Environment
* *Attacker:* Kali Linux (2023.4)
* *Target:* Internal VM â€” *10.65.147.161*

---

## Findings Overview (Summary)

| ID | Finding | CVSS (v3) | Risk | CWE | Impact |
| :--- | :--- | :--- | :--- | :--- | :--- |
| *INT-01* | SMB: Null/Weak Authentication & Sharable Scripts | 8.8 | *High* | [CWE-306](https://cwe.mitre.org/data/definitions/306.html) | Unauthorized file access & modification â†’ pivoting |
| *INT-02* | Hardâ€‘coded credentials in a deployed script | 7.5 | *High* | [CWE-798](https://cwe.mitre.org/data/definitions/798.html) | Credential disclosure â†’ lateral movement |
| *INT-03* | Excessive sudo rights for service account (NOPASSWD) | 8.0 | *High* | [CWE-269](https://cwe.mitre.org/data/definitions/269.html) | PrivEsc to root via sudo misconfig |
| *INT-04* | Unpatched internal tool with known local exploit | 7.9 | *High* | [CWE-1104](https://cwe.mitre.org/data/definitions/1104.html) | PrivEsc using published exploit chain |
| *INT-05* | Insecure temporary file usage (/tmp) by privileged service | 7.1 | *Medium* | [CWE-367](https://cwe.mitre.org/data/definitions/367.html) | Race condition â†’ file overwrites / PrivEsc |

*Overall Risk:* ðŸ”´ *High* â€” actionable local and lateral compromise achievable in lab conditions.

---

## Detailed Vulnerability Analysis

> *Note:* All PoCs below are safe, labâ€‘only examples. Do not execute on unauthorized systems.

### INT-01 â€” SMB: Null/Weak Authentication & Sharable Scripts (High)

*Description:* SMB shares expose deployment scripts and artifacts with writable permissions. smbclient and enum4linux indicated anonymous access to \\10.65.147.161\deploy\ allowing file read (and in some subcases write).

*Impact:* An attacker or lowâ€‘privileged user can retrieve or modify scripts to include malicious code (reverse shell) or change deployment behavior, facilitating lateral movement and persistence.

*Lab PoC (non-destructive):*
1.  *Enumerate shares (anonymous)*
    bash
    smbclient -L \\10.65.147.161 -N
    
2.  *Connect to deploy share & list files*
    bash
    smbclient \\10.65.147.161\deploy -N -c 'ls'
    

*Recommended Remediation (Immediate):*
* Disable anonymous SMB/guest access. Require domain/domainâ€‘like authentication.
* Restrict deploy share ACLs to administrators only.
* Ensure deployed scripts are owned by root:root and file modes set to 0640 or 0600 as appropriate.
* Implement file integrity monitoring for deployment directories (e.g., tripwire, OSSEC).

*Jira Ticket:* SEC-INT-001 â€” Disable anonymous SMB & restrict deploy share

---

### INT-02 â€” Hardâ€‘coded Credentials in Deployed Script (High)

*Description:* A deployed script in deploy/ contained an API token and an SSH key path as plaintext accessible to nonâ€‘privileged users.

*Impact:* Plaintext credentials permit lateral authentication to other hosts/services. If the credentials allow privileged actions, an attacker can pivot laterally without further exploitation.

*Lab PoC (read-only example):*
1.  *Retrieve deploy script (redacted in public copy)*
    bash
    smbclient \\10.65.147.161\deploy -N -c 'get app_deploy.sh'
    
2.  *Inspect (locally, redacted)*
    bash
    sed -n '1,120p' app_deploy.sh | sed -n '1,120p'
    

*Recommended Remediation (Immediate):*
* Remove hardâ€‘coded secrets from source files immediately.
* Rotate any credentials found (tokens, keys) and revoke old keys.
* Adopt a secrets manager (HashiCorp Vault, AWS SSM Parameter Store, Azure KeyVault) and inject secrets via secure runtime (systemd env, vault agents).
* Ensure files containing secrets are root-owned and have 0600 permissions if stored on disk.

*Jira Ticket:* SEC-INT-002 â€” Remove hardâ€‘coded secrets & rotate credentials

---

### INT-03 â€” Excessive Sudo rights for service account (High)

*Description:* serviceuser is configured with a NOPASSWD sudo entry allowing execution of /usr/bin/maintenance (or similar). The binary or its invocation chain was writable or relied on insecure temp file usage.

*Impact:* An attacker who compromises serviceuser (via above findings) can replace or manipulate the binary to escalate to root, or exploit insecure invocation paths.

*Lab PoC (enumeration):*
1.  *Enumerate sudo rights for serviceuser*
    bash
    sudo -l -U serviceuser
    
2.  *If binary is writable by serviceuser, it indicates an immediate exploit path*
    bash
    ls -l /usr/bin/maintenance
    

*Recommended Remediation (Immediate):*
* Remove NOPASSWD entries unless strictly necessary.
* Scope sudoers to exact binary paths and permitted arguments only (Cmnd_Alias, User_Alias).
* Ensure binaries run via sudo are owned by root:root and chmod 755 (not world-writable).
* Consider using tools like sudoers.d scoped entries and log sudo commands.

*Jira Ticket:* SEC-INT-003 â€” Restrict serviceuser sudo entries

---

### INT-04 â€” Unpatched Internal Tool (High)

*Description:* /opt/internal-tool/bin/tool matches an outdated version with known local privilege escalation exploits (version fingerprint matched published advisories).

*Impact:* Known exploits could allow arbitrary code execution as root, enabling full host compromise.

*Lab PoC (version check):*
1.  *Check binary version (example)*
    bash
    /opt/internal-tool/bin/tool --version
    
2.  *Check file metadata*
    bash
    ls -l /opt/internal-tool/bin/tool
    strings /opt/internal-tool/bin/tool | grep -i 'version'
    

*Recommended Remediation (Shortâ€‘term):*
* Patch to the vendorâ€‘provided fixed version immediately.
* If patch unavailable, remove or disable the service until mitigations are identified.
* Run the tool with reduced privileges inside a container or under AppArmor/SELinux policy.
* Remove unnecessary setuid/setgid bits from binaries unless required.

*Jira Ticket:* SEC-INT-004 â€” Patch or remove vulnerable internal tool

---

### INT-05 â€” Insecure Temporary File Usage (Medium)

*Description:* A privileged service writes temporary files to /tmp without using secure APIs (no O_EXCL/mkstemp), enabling an attacker to create symlink or race conditions.

*Impact:* Race condition can be exploited to overwrite files or inject content, facilitating privilege escalation or local code execution.

*Lab PoC (conceptual):*
1.  *Demonstrate suspicious tmp usage (example)*
    bash
    ps aux | grep internal-service
    
2.  *Review code excerpts (redacted)*
    bash
    sed -n '1,200p' /opt/internal-tool/scripts/handler.sh
    

*Recommended Remediation (Short/Medium):*
* Replace insecure temp file creation with mkstemp() or language-appropriate secure APIs.
* Use private temp directories (/var/tmp/appname-XXXXXX) with strict permissions.
* Run services with least privilege; apply filesystem ACLs.

*Jira Ticket:* SEC-INT-005 â€” Fix insecure temp file usage

---

## Exploitation Timeline (lab verified)

| Phase | Time Taken | Summary |
| :--- | :--- | :--- |
| *Reconnaissance* | 10 mins | Nmap + SMB enumeration |
| *SMB Enumeration* | 20 mins | Share discovery & file listing |
| *Credential Discovery* | 15 mins | Discovered hardâ€‘coded token in deploy script |
| *Lateral Attempt* | 20 mins | Used creds to access adjacent lab host |
| *Privilege Escalation* | 25 mins | Sudo misconfig + outdated binary exploited |
| *Documentation* | 1 hr | Report writing & remediation prep |

---

## Technical Proof & Screenshots (redacted references)

> Raw artifacts (screenshots, logs) are included in the delivery package. Public artifacts are redacted to remove flags/credentials. Private raw artifacts available under NDA.

*Files (public, redacted):*
* screenshots/SS01_Nmap10.65.147.161.png â€” initial host fingerprint
* screenshots/SS02_SMBEnum10.65.147.161.png â€” anonymous SMB listing
* screenshots/SS03_DeployScriptExcerpt_redacted.png â€” redacted script excerpt showing variable names (tokens removed)
* screenshots/SS04_SudoList_serviceuser.png â€” sudo -l output for serviceuser
* screenshots/SS05_PrivEscProof_redacted.png â€” proof of escalation (usernames redacted)

*Recommended Evidence Naming Convention (timestamped):*
* SS01_Nmap_10.65.147.161_2025-11-20_10-08.png
* nmap_10.65.147.161_2025-11-20_10-05.txt
* smb_enum_10.65.147.161_2025-11-20_10-12.txt

> *Why timestamping matters:* It gives non-repudiable context to evidence and matches client audit expectations. Use YYYY-MM-DD_HHMM in filenames.

---

## Remediation Roadmap (Prioritized with tickets)

### Immediate (0â€“7 days) â€” P0

1.  *Disable anonymous SMB & restrict deploy share â€” SEC-INT-001*
    * *Action:* Update SMB config (smb.conf) to disable guest/anonymous. Apply ACL: setfacl -m u:deploy_admin:rwx /srv/deploy
    * *Verify:* smbclient -L \\10.65.147.161 -U <non-admin-user> should require auth.

2.  *Rotate exposed credentials immediately â€” SEC-INT-002*
    * *Action:* Revoke/rotate API tokens & SSH keys found. Issue new keys via secrets manager.
    * *Verify:* Attempt authentication with old token should fail.

3.  *Restrict sudo entries for serviceuser â€” SEC-INT-003*
    * *Action:* Remove NOPASSWD; replace with scoped sudoers: serviceuser ALL=(root) /usr/bin/maintenance --check
    * *Verify:* sudo -l -U serviceuser shows limited commands.

### Short-Term (7â€“30 days) â€” P1

1.  *Patch internal tool â€” SEC-INT-004*
    * *Action:* Update package, or remove from /opt and redeploy a patched container.
    * *Verify:* Binary version matches vendor fixed release and exploit no longer reproduces.

2.  *Fix file ownership & permissions â€” SEC-INT-005*
    * *Action:* chown root:root /srv/deploy/* && chmod 640 /srv/deploy/*
    * *Verify:* Non-admin users cannot write; ls -la shows correct perms.

### Medium / Long-Term (30â€“90+ days) â€” P2

1.  *Introduce secrets management*
    * *Action:* Implement Vault or cloud secret store, remove hard-coded secrets from repos.
    * *Verify:* No plaintext tokens in codebase; secrets injected at runtime.

2.  *Harden runtime & containment*
    * *Action:* Apply AppArmor/SELinux profiles or run legacy tools in minimal containers with limited capabilities.
    * *Verify:* AppArmor/SELinux denies unexpected syscalls; containment reduces exploit surface.

3.  *Periodic internal pentests & patch cadence*
    * *Action:* Schedule quarterly internal pentests and weekly vulnerability scanning.
    * *Verify:* Vulnerability trend improves across scans.

---

## CVSS & CWE Justification

| Finding | CVSS (v3.x) | CWE | Rationale |
| :--- | :--- | :--- | :--- |
| *INT-01* | 8.8 | [CWE-306](https://cwe.mitre.org/data/definitions/306.html) | Anonymous SMB + writable deploy shares allow unauthorized modification â†’ pivoting |
| *INT-02* | 7.5 | [CWE-798](https://cwe.mitre.org/data/definitions/798.html) | Hardcoded secrets enable credential theft and lateral access |
| *INT-03* | 8.0 | [CWE-269](https://cwe.mitre.org/data/definitions/269.html) | Excessive privileges via sudo lead to straightforward root escalation |
| *INT-04* | 7.9 | [CWE-1104](https://cwe.mitre.org/data/definitions/1104.html) | Unmaintained component with public exploit chain |
| *INT-05* | 7.1 | [CWE-367](https://cwe.mitre.org/data/definitions/367.html) | Race condition via insecure tmp usage allows file manipulation |

> *Notes on CVSS:* Scores presented are contextualized to lab/host configuration. For production scoring, adjust for environmental controls (network segmentation, detection controls).

---

## Risk Matrix & Business Impact

*Overall:* *High* â€” immediate remediation recommended.

*Business Impact Examples:*
* Unauthorized reading/modification of deployment scripts leading to supplyâ€‘chain style persistence.
* Lateral pivoting to other hosts in a segmented network, leading to broader compromise.
* Potential exposure of API tokens/keys used for production services.

*Suggested Priority:* Fix INT-01, INT-02, INT-03 within 7 days; prioritize INT-04 patching within 30 days.

---

## Delivery Package & Notes

*Recommended repository structure for delivery:*

```text
THM27_Internal/
â”œâ”€ THM27_Internal_Report.md   # (this file)
â”œâ”€ THM27_Internal_Report.pdf  # (generated from this markdown)
â”œâ”€ screenshots/
â”‚  â”œâ”€ SS01_Nmap_10.65.147.161_2025-11-20_10-05.png
â”‚  â”œâ”€ SS02_SMBEnum_10.65.147.161_2025-11-20_10-12.png
â”‚  â”œâ”€ SS03_DeployScriptExcerpt_redacted_2025-11-20_10-25.png
â”‚  â”œâ”€ SS04_SudoList_serviceuser_2025-11-20_10-40.png
â”‚  â””â”€ SS05_PrivEscProof_redacted_2025-11-20_11-10.png
â””â”€ logs/
   â”œâ”€ nmap_10.65.147.161_2025-11-20_10-05.txt
   â”œâ”€ smb_enum_10.65.147.161_2025-11-20_10-12.txt
   â”œâ”€ deploy_script_excerpt_redacted.txt
   â”œâ”€ sudo_list_serviceuser.txt
   â””â”€ privesc_commands_redacted.txt

**Redaction policy:** Public copies have flags, credentials, private keys removed. Provide full raw artifacts ato clients under NDA with a signed statement.

## Evidence / Redaction Policy

* *Public:* All secrets, flags, keys redacted. Safe excerpts (variable names, line numbers) retained for reproducibility.
* *Private (NDA):* Full raw logs, screenshots, and unredacted PoCs can be provided after NDA and secure transfer (SFTP/secure cloud link).

*Suggested NDA workflow:*
1. Provide client with GitHub/public report (redacted).
2. Client signs NDA template and requests raw package.
3. Deliver zipped raw artifacts via secure channel; log delivery in ticket.

---

## Oneâ€‘page Executive Summary (Boardâ€‘ready)

> TryHackMe â€” Room #27 (Internal) â€” Executive Summary (1 Page)

*Context:* Internal lab host exposed sensitive deployment artifacts via anonymous SMB and stored plaintext credentials. A service account had excessive sudo privileges and an internal binary was outdated with a published exploit.

*Immediate Risk:* *High* â€” local compromise can lead to root and lateral movement.
*Impact:* Potential for unauthorized modification of deployments, persistence, and access to internal resources.

*Key Actions (0â€“7 days):*
1. Disable anonymous SMB & restrict deploy share (SEC-INT-001).
2. Rotate credentials found in code and revoke compromised keys (SEC-INT-002).
3. Remove NOPASSWD sudo entries & scope privileged commands (SEC-INT-003).

*Estimated Effort:* 1â€“3 person-days for immediate actions; 2â€“4 weeks for patching & secrets management improvement.
*Owner:* Internal Ops / Platform team (assign tickets SEC-INT-001 â†’ SEC-INT-005).

*Bottom line:* Fix top three items within 7 days to significantly reduce the immediate risk vector and prevent lateral spread.

---

## Fiverr / Clientâ€‘Ready Package Suggestions

*Suggested gig title:* "I will deliver a TryHackMe room premium pentest report (exec+PoC+remediation)"

*Packages:*
* *Basic â€” $15* â€” Single room redacted PDF, executive summary, 2 screenshots. Delivery: 48 hours.
* *Standard â€” $50* â€” 5-room bundle, detailed PoCs, remediation steps, 10 screenshots. Delivery: 72 hours.
* *Premium â€” $150* â€” 10-room bundle, raw artifacts under NDA, 30-min remediation call. Delivery: 7 days.

*Gig Description Tips:*
* Include sample redacted screenshot.
* Promise NDA for raw artifacts.
* Offer a 30â€‘minute remediation call in premium package.

---

## References & Framework Mapping

* [OWASP Top 10 (2021)](https://owasp.org/www-project-top-ten/)
* [CWE (MITRE)](https://cwe.mitre.org/)
* [NIST SP 800â€‘115 (Technical Guide to Information Security Testing)](https://csrc.nist.gov/publications/detail/sp/800-115/final)
* [PEASS-ng (LinPEAS)](https://github.com/peass-ng/PEASS-ng)

---

## Personal Note to Client

> Dear Client,

Thank you for the opportunity to assess the Internal VM. This A+ Premium Markdown report is crafted for both technical and managerial consumers: detailed PoCs for engineers and an executive oneâ€‘pager for leadership. I recommend addressing SEC-INT-001 â†’ SEC-INT-003 within 7 days to reduce immediate risk.

If you want, I can now:
1. Generate a client-ready PDF from this markdown (with styled header/footer).
2. Produce the raw artifacts zip under NDA.
3. Create three Fiverr-ready package descriptions with thumbnails and pricing (Bangla + English).

Tell me which of the above youâ€™d like next and Iâ€™ll produce it.

*Prepared by:*
Asibur Rahaman â€” Ethical Hacker & Cybersecurity Specialist
[ðŸ“§ asib51639@gmail.com](mailto:asib51639@gmail.com)

*Prepared on:* November 20, 2025
*License:* [CC BYâ€‘NCâ€‘SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/) â€” Educational, nonâ€‘commercial reuse allowed with attribution.
